import os.path

from sklearn.preprocessing import LabelEncoder
from sklearn.preprocessing import MinMaxScaler
import pandas as pd

def process_malware():
    file = open('../dataset/ClaMP_Integrated-5184.csv')
    df = pd.read_csv(file, skip_blank_lines=True, na_filter=False, encoding='utf-8')

    pt = df['packer_type'].unique()
    p_masks = {pt[i]: i for i in range(len(pt))}

    df['packer_type'] = df['packer_type'].map(p_masks)

    return df

def normalization(x_train, x_test):
    scaler = MinMaxScaler()
    scaler.fit(x_train)
    columns = x_train.columns[:]
    features = x_train[columns]
    features = pd.DataFrame(
        scaler.transform(x_train),
        index=features.index,
        columns=columns
    )
    x_train[features.columns] = features
    features_test = x_test[columns]
    features_test = pd.DataFrame(
        scaler.transform(x_test),
        index=features_test.index,
        columns=columns
    )
    x_test[features_test.columns] = features_test
    return x_train, x_test