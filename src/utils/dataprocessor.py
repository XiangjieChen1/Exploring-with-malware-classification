import os.path

from sklearn.preprocessing import LabelEncoder
import pandas as pd

def process_malware(filepath):
    file = open('../dataset/ClaMP_Integrated-5184.csv')
    df = pd.read_csv(file, skip_blank_lines=True, na_filter=False, encoding='utf-8')

    le = LabelEncoder()
    pt = df['packer_type'].unique()
    p_masks = {pt[i]: i for i in range(len(pt))}

    df['packer_type'] = df['packer_type'].map(p_masks)

    return df
